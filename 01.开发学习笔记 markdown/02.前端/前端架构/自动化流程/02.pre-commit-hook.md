# pre-commit-hook实现提交前自动格式化

## 方法一是lint-staged：
`npx mrm@2 lint-staged`

为我们安装了 husky和 lint-staged并在package.json中写入相关配置内容
这个命令会根据package.json中的相关依赖自动安装配置lint-staged。所以前提先完成eslint和prettier安装。

也可以完全手动安装整个过程，更加清晰可控：
`npm install -D husky lint-staged`

其中husky用于git hooks管理。

```json
{   
    "husky":{
        "hooks": {
            "pre-commit": "lint-staged"
        }
    },
    
    "lint-staged": {
        "*.{js,css,md,ts,tsx}": "prettier --write"
    }
}
```
这里package.json的意思就是在pre-commit阶段运行lint-staged，而lint-staged对以js,css,md,ts,tsx为后缀的文件执行prettier自动格式化。

新版本husky在根目录下创建.husky文件夹统一管理执行脚本了，无需在package.json中配置husky字段。

pre-commit:
```
#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

npx lint-staged
```

commit-msg:
```
#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

npx --no -- commitlint --edit
```

配置完成 这样在下一次git commit前，prettier会自动格式化我们的文件。

## 方法2 pretty-quick
`npx husky-init`
`npm install -D pretty-quick`

其中husky方便git hooks管理，pretty-quick可以更加高效执行prettier。