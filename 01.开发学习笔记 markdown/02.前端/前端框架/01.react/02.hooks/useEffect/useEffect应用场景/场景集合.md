尽量减少useEffect使用 它是副作用

# 组件有依赖外部props的属性变化作一些操作 
比如默认值


# 依赖了某些值，但是我不要在初始化就执行回调方法，我要让依赖改变再去执行回调方法
我们这里有用到了 useRef 这个钩子：

```js
const firstLoad = useRef(true);
useEffect(() => {
  if (firstLoad.current) {
    firstLoad.current = false;
    return;
  }
  // do something...
}, [ xxx ]);
```

# 我有一个getData的异步请求方法，我要让其在初始化调用且点击某个按钮也可以调用
我们先这样写

```js
// ...
  const getData = async () => {
    const data = await xxx({ id: 1 });
    setDetail(data);
  };

  useEffect(() => {
    getData();
  }, []);

  const handleClick = () => {
    getData();
  };
// ...
```

但是报了个warning：

Line 77:6:  React Hook useEffect has a missing dependency: 'getData'. 
Either include it or remove the dependency array 
react-hooks/exhaustive-deps
报错的意思就是：我需要 useEffect 需要添加getData依赖

这是Hook的规则，于是我们这样改：

```
// ...
  const getData = async () => {
    const data = await xxx({ id: 1 });
    setDetail(data);
  };

  useEffect(() => {
    getData();
  }, [getData]);

  const handleClick = () => {
    getData();
  };
// ...
```
但是又报了个warning：

Line 39:9:  The 'getData' function makes the dependencies of useEffect Hook (at line 76) change on every render. 
Move it inside the useEffect callback. 
Alternatively, wrap the 'getData' definition into its own useCallback() Hook  react-hooks/exhaustive-deps
报错的意思就是：这个组件只要一有更新触发了render， getData 的就会重新被定义，此时的引用不一样，会导致useEffect运行。

这个是影响性能的行为，我们用 useCallback 钩子来缓存它来提高性能：

```js
// ...
  const getData = useCallback(async () => {
    const data = await xxx({ id: 1 });
    setDetail(data);
  }, []);

  useEffect(() => {
    getData();
  }, [getData]);

  const handleClick = () => {
    getData();
  };
// ...
```

这只是一个例子，主要是为了说明 根据错误提示，从而引起的思考。当然你也可以用一个注释来关闭eslint，或者直接关闭eslint规则，这主要看你的取舍。
使用 // eslint-disable-next-line react-hooks/exhaustive-deps，如：

```js
// ...
  const [count, setCount] = useState(1);
  const xxx = () => {};
  useEffect(() => {
    // use count do something...
    console.log(count);    

    xxx();
    // eslint-disable-next-line react-hooks/exhaustive-deps
  }, []);
// ...
```
