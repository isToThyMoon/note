
hashRouter和browserRouter区别：
利用的浏览器api不同，hashRouter基于改变location对象中的hash来实现，browserRouter基于history对象的一些api来实现。

区别是改变hash并不会向服务器发起一条新请求，而除了hash外改变url是会请求服务器重载页面的。

首先确认历史记录如何产生，简而言之，只要当页面的URL改变时，就会生成一条历史记录。在IE8及更高的版本中、Opera、Firefox、Chrome、Safari3及更高的版本中改变hash也会生成一条历史记录。生成的历史记录以栈的形式存在，使用history api可进行管理。

所以无论是hash还是browserRouter，都会产生历史记录进行网页历史管理。

## location 对象
用来管理 URL 的, 下面是例子

改变 href 属性就可以跳转页面
hash: ""
host: "s.taobao.com"
hostname: "s.taobao.com"
href: "https://s.taobao.com/search?q=3ds&imgfile=&js=1&stats_click=search_radio_all&ie=utf8"
search: "?q=3ds&imgfile=&js=1&stats_click=search_radio_all&ie=utf8"
origin: "https://s.taobao.com"
pathname: "/search"
port: ""
protocol: "https:"
reload: 函数, 刷新当前页面
replace: 函数, 替换当前页面, 有参数

如果用location.href = '' 来做页面跳转，要填写完整的http头 否则会被拼接到当前href的域名之后来跳转

改变hash并不会向服务器发起一条新请求，但是又确实新增了一条历史记录。

前端框架库的hash模式路由就是基于location.hash的特性来实现的。通过监听hashchange事件实现相关功能。

## history 对象
window.history 对象提供了对浏览器的会话历史的访问，它暴露了很多有用的方法和属性，允许你在用户浏览历史中向前和向后跳转，同时——从 HTML5 开始——提供了对 history 栈中内容的操作。


在 HTML5 它增加了一些 API 使得它也可以做单页应用(SPA, single page app)，是browserRouter的实现基础。

history api基础属性方法：
history.length      // 保存历史列表中的 url 数量

history.back()      // 相当于浏览器中点击后退按钮
history.forward()   // 相当于浏览器中点前进按钮
history.go(-2)      // 加载history列表中某个具体页面，这里为-2相当于点击两次后退按钮

history对一个窗口页面有效
如果你连续跳转了三个页面 history历史长度为3
回退2个页面到第一个页面 再跳转新的一个页面
history长度为2
之前长度为3 history其实已经被覆盖了 
很好理解。

history H5新增属性方法：
history.state 保存记录对象
history.pushState() 向浏览器的历史记录中添加一个状态
history.replaceState() 修改当前历史记录实体 和pushState一样但是不生成新历史记录

最主要的 API 有以下两个：history.pushState() 和 history.repalceState()

### history.pushState() history.repalceState()
只能在相同域名下
可以使用 queryString
主要作用是来做 SPA

`history.pushState(null, 'title', "/profile")`
三个参数分别是
    自定义对象
    新页面的标题, 但是现在还没有浏览器实现这个功能
    新页面的地址

```js
var state = {
    page: "settings"
}
history.pushState(state, "settings", "/settings")
```

 replaceState 函数, 它的作用和 pushState 一样, 只是不生成一条历史纪录

## window.onpopstate 事件
当活动历史记录条目更改时，将会触发popstate事件
能够实时拦截用户点击前进按钮和后退按钮的操作，但不能够区分用户到底点击的是前进按钮还是后退按钮。

需要注意调用history.pushState() 和 history.repalceState()不会触发popstate事件，只有作出浏览器前进后退实际动作时才会触发。如：
用户点击 前进 后退 按钮的时候；
调用history.back() history.forward()；

不同的浏览器在加载页面时处理popstate事件的形式存在差异。页面加载时Chrome和Safari通常会触发(emit )popstate事件，但Firefox则不会。

页面根据hash变化跳转时候也会触发popstate事件。

于是可以在这里操作：

```
window.addEventListener("popstate", function(e) {
    var state = e.state;
    // state 就是 pushState 的第一个参数
    console.log('pop state', state)
})

```
