


整体俯瞰下Vue构造函数的代码：
```js
function Vue (options) {
	// 用于初始化的方法，在实例产生时被调用
  this._init(options)
}

initMixin(Vue)
stateMixin(Vue)
eventsMixin(Vue)
lifecycleMixin(Vue)
renderMixin(Vue)

export default Vue
```

为了兼容性 Vue源码采用es5创建类和实例的方法。没有采用class。
构造方法constructor的内容只有一行代码 实例调用执行Vue原型上的_init方法
注意到这几行代码并没有_init方法，那一定是下面几个mixin做的（initMixin方法为Vue构造函数挂载了_init方法）。

看下_init()方法为vm实例做了哪些处理：
```js
// uid是一个全局共享的变量，并不在构造函数中，因此每次调用都会+1，这样可以确保每个组件的_uid都不一样。
let uid = 0
Vue.prototype._init = function (options) {
	const vm: Component = this
	// 实例唯一id
	vm._uid = uid++

	// 内部标记，主要用于防止被当成普通对象来监听变化
	// 标记对象为Vue实例，如果这个组件实例在后续被当作普通对象来监听变化时，能识别出这是一个Vue实例。
	vm._isVue = true
	
	// merge options
	// 如果选项_isComponent 为 true，则说明组件是一个自定义组件。会调用 initInternalComponent 方法，会写入 parent/_parentVnode/propsData/_parentListeners/_renderChildren/_componentTag 属性。如果 render 选项存在，还会写入 render/staticRenderFns。
	if (options && options._isComponent) {
	  // optimize internal component instantiation
	  // since dynamic options merging is pretty slow, and none of the
	  // internal component options needs special treatment.
	  initInternalComponent(vm, options)
	  
	// 如果不是内部组件，则会合并组件的 constructor（即 Vue 构造函数）的调用参数、options 对象，还有 vm 实例本身的属性（也就是说包括上面的_uid 之类的都会合并进去）。（Vue.options 是一个预先定义好的配置对象。）
	} else {
	  // $options 实例初始化时传入的选项 通过merge挂载
	  vm.$options = mergeOptions(
	    resolveConstructorOptions(vm.constructor),
	    options || {},
	    vm
	  )
	}
	
	// 实例的Proxy包装代理 当在开发环境访问不存在的属性时产生提示
	vm._renderProxy = vm

	// expose real self
	// 把vm自己挂载上去
	vm._self = vm
	
	// 下面都是初始化代码 这些方法也是之前各自的Mixin添加的
	// 初始化生命周期
	initLifecycle(vm)
	// 初始化事件绑定
	initEvents(vm)
	// 初始化render
	initRender(vm)
	// 调用钩子 beforeCreate 此时组件的data和method还没有初始化好
	callHook(vm, 'beforeCreate')
	// 初始化依赖注入 injections
	initInjections(vm) // resolve injections before data/props
	// 初始化状态 state
	initState(vm)
	初始化依赖注入 Provide
	initProvide(vm) // resolve provide after data/props
	// 调用钩子 created 组件的data和methods已经初始化好
	callHook(vm, 'created')

	// 如果声明了el（绑定dom父元素），则调用$mount。
	// 其他钩子会在$mount中调用
	if (vm.$options.el) {
	  vm.$mount(vm.$options.el)
	}
}
```

除了_init方法在初始化过程中处理了一些成员，其他阶段也各自分工挂载了一些成员：

init:
_init() 用于初始化的方法，在实例产生时被调用
_uid 实例唯一 id
_isVue 标识是否是 Vue 实例
_renderProxy 实例的 Proxy 包装代理，当在开发环境访问不存在的属性时产生提示
_self 引用自身
$options 实例初始化时传入的选项。 $options 是 Vue 实例的选项，在前面的代码中，我们看到初始化时会 $options 上会添加一些成员（components、directives、filters 等）。$options 另一部分来自初始化 Vue 实例时传递的参数，在上述例子中，我们在调用 new Vue() 时传入了一个对象 options，它包含 template、data、el 三个成员，而这三个成员将成为 $options 的一部分。

lifycycle:
$parent 指向父 Vue 实例
$root 指向根 Vue 实例
$children 包含子 Vue 实例的引用
$refs 实例中包含的引用（参见相关文档）
_watcher 与实例关联的 watcher 对象
_inactive 与_directInactive 都是使用 keep-alive 时标记组件是否是活跃的
_directInactive 与_inactive 都是使用 keep-alive 时标记组件是否是活跃的
_isMounted 标记实例是否已挂载
_isDestroyed 标记实例是否已被销毁
_isBeingDestroyed 标记实例是否正在被销毁

events:
_events 存储与实例关联的事件回调函数
hasHookEvent 标记是否监听了 hook 事件

render:
_vnode 虚拟 DOM
_staticTrees 存储静态渲染的节点
$vnode 父节点的虚拟 DOM 引用
$slots slots
$scopedSlots 作用域 slots
_c 创建 VNode 的方法
$createElement 创建 VNode 的方法
$attrs Vue 实例上的属性
$listeners Vue 实例上绑定的事件

state:
_watchers Watcher 实例引用
_data 数据（状态）引用
_provided 组件中通过 provide 提供的内容的引用