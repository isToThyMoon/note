# react native

必须安装的依赖有：Node、Watchman、Xcode 和 CocoaPods。
node用nvm控制安装。node version>=16

`brew install watchman` Facebook 提供的监视文件系统变更的工具。安装此工具可以提高开发时的性能（packager 可以快速捕捉文件的变化从而实现实时刷新）。

Xcode React Native 目前需要Xcode 12 或更高版本。

Xcode 的命令行工具：启动 Xcode，并在Xcode | Preferences | Locations菜单中检查一下是否装有某个版本的Command Line Tools。Xcode 的命令行工具中包含一些必须的工具，比如git等

在 Xcode 中安装 iOS 模拟器


rbenv 安装ruby
rbenv作为ruby的管理工具
brew install rbenv ruby-build
安装成功后输入rbenv可以看到相关提示。
安装指定版本ruby:
rbenv install 2.7.6
安装成功后，在本地环境中让此版本生效：
rbenv global 2.7.6
查看本机ruby版本：
ruby --version
查看ruby捆绑的包管理工具gem的PATH：
which gem

CocoaPods是用 Ruby 编写的包管理器（可以理解为针对 iOS 的 npm）。从 0.60 版本开始 react native 的 iOS 版本需要使用 CocoaPods 来管理依赖。你可以使用下面的命令来安装 CocoaPods。CocoaPods 的版本需要 1.10 以上。

当然安装可能也不顺利，请使用代理软件。

sudo gem install cocoapods（最好rvm安装好ruby版本后 再使用gem安装，和node一样，不同版本的ruby都有不同版本的gem）

~~或者可以使用 brew 来安装 （最好别这样安装 似乎容易识别不到pod） brew install cocoapods~~

创建项目：
请不要在目录、文件名中使用中文、空格等特殊符号。请不要单独使用常见的关键字作为项目名（如 class, native, new, package 等等）。请不要使用与核心模块同名的项目名（如 react, react-native 等）。

0.60 及以上版本的原生依赖是通过 CocoaPods 集成安装的。CocoaPods 的源必须使用代理访问（镜像源也无效）。如果在 CocoaPods 的依赖安装步骤卡住（命令行停在 Installing CocoaPods dependencies 很久，或各种网络超时重置报错，或在 ios 目录中无法生成.xcworkspace 文件），请务必检查确定你的代理配置是否对命令行有效。

npx react-native@latest init AwesomeProject

init命令中 Downloading template 如果很慢 注意使用淘宝npm镜像源 但全程使用代理访问，因为CocoaPods安装非常多的依赖，国外访问非常慢 大约半小时

安装cocoapods依赖可能会失败，可以手动进入ios目录然后手动bundle安装，如下：
```
Run instructions for Android:
    • Have an Android emulator running (quickest way to get started), or a device connected.
    • cd "/Users/tothymoon/files/code/myRNProject2" && npx react-native run-android

  Run instructions for iOS:
    • cd "/Users/tothymoon/files/code/myRNProject2/ios"

    • Install Cocoapods
      • bundle install # you need to run this only once in your project.
      • bundle exec pod install
      • cd ..

    • npx react-native run-ios
    - or -
    • Open myRNProject2/ios/myRNProject2.xcodeproj in Xcode or run "xed -b ios"
    • Hit the Run button
```
需要先安装node mudule再执行bundle install，否则会找不到react-native文件
bundle exec pod install可能一直报http stream错误，是因为命令行buffer限制，
git config --global http.version HTTP/1.1
git config --global http.postBuffer 157286400
解除限制，还不行的话就重启下就会好。

启动：
cd AwesomeProject 
yarn ios
或者
yarn react-native run-ios

此命令会对项目的原生部分进行编译，同时在另外一个命令行中启动`Metro`服务对 js 代码进行实时打包处理（类似 webpack）。`Metro`服务也可以使用`yarn start`命令单独启动。
> 提示：如果此命令无法正常运行，请使用 Xcode 运行来查看具体错误（run-ios 的报错没有任何具体信息）。
在正常编译完成后，开发期间请保持`Metro`命令行窗口运行而不要关闭。以后需要再次运行项目时，如果没有修改过 ios 目录中的任何文件，则只需单独启动`yarn start`命令。如果对 ios 目录中任何文件有修改，则需要再次运行`yarn ios`命令完成原生部分的编译。

`yarn ios`只是运行应用的方式之一。你也可以在 Xcode 中直接运行应用。注意 0.60 版本之后的主项目文件是`.xcworkspace`，不是`.xcodeproj`。