---
title: 02.请求头响应头、ip协议
categories:
  - 01.开发学习笔记 markdown
  - 07.前端
  - 00.网络相关
---

# 网址组成（四部分）
协议      http, https（https 是加密的 http）
主机      g.cn  zhihu.com之类的网址
端口      HTTP 协议默认是 80，因此一般不用填写 是一个 16 位的数字，所以范围是 0-65535（2**16）
路径      下面的「/」和「/question/31838184」都是路径

http://www.zhihu.com：80/question/3183818481

# HTTP协议
一个传输协议，协议就是双方都遵守的规范。
为什么叫超文本传输协议呢，因为收发的是文本信息。
1，浏览器（客户端）按照规定的格式发送文本数据（请求）到服务器
2，服务器解析请求，按照规定的格式返回文本数据到浏览器
3，浏览器解析得到的数据，并做相应处理

请求和返回是一样的数据格式，分为3部分(除去换行分隔符)：
1，请求行或者响应行
2,\r\n
3，Header（ https头 请求的 Header 中 Host 字段是必须的，其他都是可选）
5，\r\n\r\n（连续两个换行回车符，用来分隔Header和Body）
5，Body（可选 数据体）

## 请求和响应格式：
### get请求
具体超文本信息字符串是 `GET /路径 HTTP/1.1\r\nhost:g.cn......\r\n\r\n`
注意大小写，注意代表路径的/左右两个空格，其中：
1， GET 是请求方法（还有POST等，这就是个标志字符串而已）
2，/ 是请求的路径（这代表根路径）
3，HTTP/1.1  中，1.1是版本号，通用了20年

转成更易理解的格式：
```
GET / HTTP/1.1
Host: g.cn

body部分
```
也有其他Header如Connection：keep alive 字段 表示不关闭连接 下面传输数据如很多网页内图片等 继续复用这个tcp连接

get请求方式发送时信息放在路径里发送 多个信息用&隔开，post请求方式发送时信息放在body里发送 如 message=aaa
如get请求头：`GET /路径?name=ayrikiya&password=123 HTTP/1.1`
url 的规范
第一个 ? 之前的是 path
? 之后的是 query部分
```
‘http://c.cc/search?a=1&b=2&c=1’
PATH  /search
QUERY a=b&c=d&e=1
```

### 响应：
完整请求字符串：

```
GET /路径 HTTP/1.1
Host: localhost:2000
Connection: keep-alive
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.110 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8
Accept-Encoding: gzip, deflate, br
Accept-Language: zh-CN,zh;q=0.9
```

服务器返回的数据如下

```
HTTP/1.1 301 Moved Permanently
Alternate-Protocol: 80:quic,p=0,80:quic,p=0
Cache-Control: private, max-age=2592000
Content-Length: 218
Content-Type: text/html; charset=UTF-8  （描述body部分是文本类型/html格式 以UTF-8编码）
Date: Tue, 07 Jul 2015 02:57:59 GMT
Expires: Tue, 07 Jul 2015 02:57:59 GMT
Location: http://www.google.cn/
Server: gws
X-Frame-Options: SAMEORIGIN
X-XSS-Protection: 1; mode=block
```

Body部分太长，先不贴了
其中响应行（第一行）：
1，HTTP/1.1 是版本
2，301 是「状态码」，参见文末链接
3，Moved Permanently 是状态码的描述

浏览器会自己解析Header部分，然后将Body显示成网页
比较重要的一些头：
Content-Type: text/html; charset=UTF-8  （描述body部分是文本类型/html格式 以UTF-8编码）
Content-Type规定了body部分返回给客户端的是什么类型，浏览器将按照特定类型解析body的stream流或者文本。




# 预检请求
当请求满足下述任一条件时，即应首先发送预检请求：

使用了下面任一 HTTP 方法：
PUT
DELETE
CONNECT
OPTIONS
TRACE
PATCH

人为设置了对 CORS 安全的首部字段集合之外的其他首部字段。该集合为：
Accept
Accept-Language
Content-Language
Content-Type:
    application/x-www-form-urlencoded
    multipart/form-data
    text/plain
DPR
Downlink
Save-Data
Viewport-Width
Width



# 请求和响应字段

请求：

## 成功请求 打印出响应：
```
response：
{
  // `data` 由服务器提供的响应
  data: {},

  // `status` 来自服务器响应的 HTTP 状态码
  status: 200,

  // `statusText` 来自服务器响应的 HTTP 状态信息
  statusText: 'OK',

  // `headers` 服务器响应的头
  headers: {},

  // `config` 是为请求提供的配置信息
  config: {},
  // 'request'
  // `request` is the request that generated this response
  // It is the last ClientRequest instance in node.js (in redirects)
  // and an XMLHttpRequest instance the browser
  request: {}
}
```

## 失败请求 打印响应：
都在error.response中

```
// The request was made and the server responded with a status code
// that falls out of the range of 2xx
error.response：
    config:
    data:
    headers:
    request:
    status:
    statusText:
    
// The request was made but no response was received
// `error.request` is an instance of XMLHttpRequest in the browser and an instance of
// http.ClientRequest in node.js
error.request
    
// Something happened in setting up the request that triggered an Error
console.log('Error', error.message);

```