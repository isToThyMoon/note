# 错误捕获
react内部js错误导致整个应用崩溃。
作为一个框架，react提供了解决方案。

## ErrorBoundary错误边界
错误边界是⼀种 React 组件，这种组件可以捕获发⽣在其⼦组件树任何位置的js错误，
打印这些错误，同时展示降级UI。
⽽并不会渲染那些发⽣崩溃的⼦组件树。

形成错误边界组件的两个条件：

● 使⽤了 static getDerivedStateFromError()

● 使⽤了 componentDidCatch()


抛出错误后，请使⽤ static getDerivedStateFromError() 渲染备⽤ UI，
componentDidCatch() 打印错误信息。

写一个错误边界组件：
```js
class ErrorBoundary extends React.Compoent {
	constructor(props) {
		super(props);
		this.state = {
			hasError: false
		};
	}

	static getDerivedStateFromError(error) {
		// 更新state以显示降级UI
		return { hasError: true };
	}

	componentDidCatch(error, errorInfo) {
		// 得到日志并上报
		logErrorToMyService(error, errorInfo);
	}

	render() {
		if (this.state.hasError) {
			return <h1>something went wrong</h1>;
		}

		return this.props.children;
	}
}
```
使用
```
<ErrorBoundary> 
<MyWidget />
</ErrorBoundary>
```


下⾯这些情况⽆法捕获到异常：

● 事件处理

● 异步代码

● 服务端渲染

● ⾃身抛出来的错误

如事件处理中无法被错误边界捕获的错误，可以使用try catch等。
或onerror监听全局的error事件