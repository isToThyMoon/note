
# Next
建议使用 create-next-app创建新的 Next.js 应用程序，它会自动为你设置所有内容。

如果你希望使用 TypeScript 开发项目，可以通过 --typescript 参数创建 TypeScript 项目：
`npx create-next-app@latest --typescript`

会按选项安装主要的依赖：
```
Installing dependencies:
- react
- react-dom
- next

Installing devDependencies:
- typescript
- @types/node
- @types/react
- @types/react-dom
- autoprefixer
- postcss
- tailwindcss
- eslint
- eslint-config-next
```

# router
next的核心是实现了服务端的预渲染，如ssg ssr isr，新版本react18➕next13实现了rsc（react server component），可以从组件粒度组合实现混合渲染了。rsc和csc混合。以前页面级别的ssg ssr也还是可选的。

next以app router的实现引入了react18的一些服务端渲染新特性，将rsc落地。

所以这两种router的选用非常重要。

next提供了page router和app router两种方式。

page router适配的是SSR SSG，app router适配的是RSC。两者渲染的粒度不一样。

- `SSR`、`SSG`是页面级别的（服务端渲染呈现的是整个页面）
- `RSC`是组件级别的（服务端组件请求数据源）


## page router
项目根目录下：pages/index.tsx 这种写法就开启了page router。

这种路由下你可以使用getStaticProps / getStaticPaths / getServerSideProps区分组件是ssg还是ssr。这是页面级别的渲染。


## app router

项目根目录下：src/app/page.tsx 这种写法就开启了app router。

默认开启ssr，如果需要csr，文件头部加上'use client'标记。一个组件被标记为csr，它的children都是客户端渲染了。


# nextjs配合全栈

浏览器请求：
浏览器发起/page请求
koa/express接收到请求，调用next.js
next.js开始渲染
调用 App/页面的getStaticProps/getServerSideProps（getInitialProps废弃）...
渲染最终html
返回给浏览器并实际渲染给用户


客户端路由跳转：
点击链接按钮跳转
异步加载页面的组件js
调用页面的getServerSideProps...
数据返回，路由变化
渲染出新页面


