# 最大的项目 介绍下你的项目架构和难点

## 亮点

项目背景，焦点科技主营业务是B2B的外贸电商平台，对接撮合国内生产商和国外买家达成交易并盈利。业务至今20多年有一套jsp前后端不分离的松散管理页面的历史积累，生产商作为平台付费客户，那么需要一个功能更集中的管理平台对生产商的用户画像，活跃数据，付费情况、回款等各方面信息做收集整理，提供给销售和运营作为营销拓展利润的数据基础和技术支持。同时也对销售的个人业绩，部门业绩，整体业绩趋势等纳入系统管理，作为他们日常工作评估的参考。



工程化上，项目以webpack为打包工具构建一套符合公司需求的配置，less变量抽出文件，统一定制antd主题和色值，统一配置按需加载 多入口打包 treeshaking等。

项目规范化上：统一配置git commit规范 eslint规则和prettier规范 利用husky工具在commit时实现commit信息和prettier的自动化检查和rewrite。



项目架构上以前端路由react-router构建spa系统页面，

权限管理，同时做接口层 菜单层 路由层 组件层的权限管理。

侧边菜单分级对提供给运营和销售的系统工具进行菜单分类，有一些旧页面未改造到，使用频率过低的，对接其他横向部门产品，页面嵌入，当时没考虑用微前端框架，而是由路由守卫做一层url的区分，使用iframe嵌入引入到系统的主体展示区域。通过iframe的postMessage和新系统进行数据传输。也方便了渐进式的项目重构，和多页面功能的集合。

采用常规前后端分离分离模式，数据层分层，使用redux-toolkit作为客户端状态管理，RTK-query作为服务端状态管理，RTK-query可以定制底层请求库，使用axios利用范型定制封装接口提供接口返回值的类型提示，拦截器响应器实现系统统一的请求状态全局message，实现双token无感刷新。
另外项目的消息推送功能使用mitt事件总线封装eventSource来实现服务端信息推送。



编写统一的Error Boundary组件对react内部错误进行捕获上传接入公司的神策前端监控，并且提供统一的error兜底UI，提供刷新返回首页的机制。


对项目的核心第三方库echarts和百度地图的类实例封装单例模式，集合绘制、卸载等统一操作防止内存泄露和性能问题。
地图模式拓客模式首页展开百度地图，对各省的数据进行显示和排名 以及下钻具体区级详细的供应商数据整合跟进，直接与已注册供应商快速沟通，未注册用户记录沟通信息，安排行程。

可分类搜索对全国供应商资源进行整合展示，下钻最深层级浮动展示供应商基本信息，跳转详细供应商画像页面。

地图下钻的过程，需要不断的绘制地图，因此，首先定义一个绘制地图的函数。

正常模式下首页对销售的个人业绩个人信息和部门情况进行可视化的数据展示

对无尽滚动的需求 做虚拟滚动实现。

大量的查询表格和echarts图表动态展示 做node中间层，导出文件。
前端dom图表截图需求，根据图表生成图片插入导出客户报告 需求把前端图片传递给后端并整合成文档由用户web下载 一开始准备采用直接截取dom转图片的形式 后面考虑到用户量和传输的时间，在服务端架设一个node中间层服务器，由后端自己请求node的图片


透明页 
loading态
预渲染 预先请求拿到数据

axios封装链调用 发四次请求 失败后重置初始态
封装常规请求返回拦截器 实现全局统一的loading success fail态。


## 难点：

财务回款相关操作，筛选表格数据存在取消回退操作，需要前端记录操作步骤回退

首页供应商搜索功能，无尽滚动，大量dom优化，虚拟滚动。

性能优化：
大数据表格 收集渲染

虚拟滚动 （ 取消 createPortal ）

页面错误边界 错误返回边界（做的一些处理）




cookie劫持

数据持久化

文件上传和下载

断网处理

前端渲染 文档

eventSource()