---
title: 13
categories:
  - 项目实录整理
  - 后端项目
  - 实战 flask高级编程  鱼书项目
---

``` python

from sqlalchemy import Column, String, Integer
from app.models.base import Base


class Drift(Base):
    """
    一次具体的交易信息
    """
    id = Column(String(20), primary_key=True)
    # 邮寄信息
    recipient_name = Column(String(20), nullable=False)
    address = Column(String(10), nullable=False)
    message = Column(String(200))
    mobile = Column(String(20), nullable=False)

    # 书籍信息
    isbn = Column(String(13))
    book_title =  Column(String(50))
    book_author = Column(String(30))
    book_img = Column(String(50))

    # 请求者信息
    requester_id = Column(Integer)
    requester_nickname = Column(String(20))

    # 赠送者信息
    gifter_id = Column(Integer)
    gift_id = Column(Integer)
    gifter_nickname = Column(String(20))

    # requester_id = Column(Integer, ForeignKey('user.id'))
    # requester = relationship('User')
    # gift_id = Column(Integer, ForeignKey('gift.id'))
    # gift = relationship('Gift')

```


为什么没有用 relationship 作数据表的关联？

两种方案：
1 模型关联
如果用模型关联  下载记录下的user名字 是a 过了一阵子名字改为b
我们在查询drift记录时只会查到b  无法查到a这样的历史名字

这种交易记录作为一种历史状态的记录时不应该被轻易改变的

2 重复冗余记录



模型中有关联 每次查询时的关联模型信息都是最新的 没有忠实记录交易时的状态 关联查询需要查询多张表 查询速度较慢

无关联  有数据的冗余 容易在多张表中造成数据的不一致
