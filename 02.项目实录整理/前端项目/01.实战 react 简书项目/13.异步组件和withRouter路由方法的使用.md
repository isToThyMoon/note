---
title: 13.异步组件和withRouter路由方法的使用
categories:
  - 项目实录整理
  - 前端项目
  - 03.实战 react 简书项目
tags:
  - react项目
date:
---

现在进入页面所有的js都在一个bundle.js里 切换其他页面也没有请求加载其他js文件
那么各个页面的js文件应该是分开的 进入哪个页面就应该请求哪个页面的js 提高加载效率

使用封装好的第三方库  异步组件
yarn add react-loadable

在需要使用的组件目录下新建一个loadable组件

```JavaScript
import React from 'react';
import Loadable from 'react-loadable';

const LoadableComponent = Loadable({
  loader: () => import('./index.js'),
  loading() {
  	return <div>正在加载</div>
  }
});

export default () => <LoadableComponent />

```

在app.js里使用

`import Detail from './pages/detail/loadable.js';`

但是会报错 因为
在原来app.js的router中

	<BrowserRouter>
	<div>
		<Header />
		<Route path='/' exact component = {Home}></Route>
		<Route path='/login' exact component = {Login}></Route>
		<Route path='/detail/:id' exact component = {Detail}></Route>
		<Route path='/write' exact component = {Write}></Route>
	</div>
	</BrowserRouter>

其他组件如list组件触发<Link key = {index} to = {'/detail/' + item.get('id')}>
 引起path='/detail/:id' 跳转 这里的id传递给子组件Detail 通过this.props.match.params.id得到

 现在路由传递给了异步组件<LoadableComponent /> 但异步组件包裹的<Detail/>组件接收不到了


 解决 ：
在detail组件中（index.js）:

	import { withRouter } from 'react-router-dom';

然后在connect时：

	export default connect(mapState, mapDispatch)(withRouter(Detail));
