---
title: 13
categories:
  - 项目实录整理
  - 前端项目
  - 04.实战 react 共享单车项目（lese）
---

### 登录表单
通过 
const { getFieldDecorator } = this.props.form; 

``` javascript
class FormLogin extends Component {

	render() {

		const { getFieldDecorator } = this.props.form; 
		return (
			<div>
				<Card title="登录行内表单">
					<Form layout="inline">
						<FormItem>
							<Input placeholder="请输入用户名"></Input>
						</FormItem>

						<FormItem>
							<Input placeholder="请输入密码"></Input>
						</FormItem>

						<FormItem>
							<Button type="primary">登录</Button>
						</FormItem>
					</Form>
				</Card>

				<Card title="登录水平表单" style={{marginTop:10}}>
					<Form layout="horizontal" style={{width:300}}>
						<FormItem>
							{
								getFieldDecorator('userName',{
									initialValue: 'dadada',
									rules: [
										{
											required: true,
											message: '用户名不能为空'
										},
										{
											min:3, max:10,
											message: '长度3到10个字符'
										},
									]
								}) (
									<Input prefix={<Icon type="user"></Icon>} placeholder="请输入用户名"></Input>
								)
							}
							
						</FormItem>

						<FormItem>
							{
								getFieldDecorator('userPwd',{
									initialValue: '',
									rules: [
										
									]
								}) (
									<Input prefix={<Icon type="lock"></Icon>} type="password" placeholder="请输入密码"></Input>
								)
							}
							
						</FormItem>
						
						<FormItem>
							{
								getFieldDecorator('remember',{
									valuePropName: 'checked',
									initialValue: true,
									rules: []
								}) (
									<Checkbox>记住密码</Checkbox>
								)
							}
							<a href="#/" style={{float:'right'}}>忘记密码</a>
						</FormItem>

						<FormItem>
							<Button  type="primary" onClick={this.handleSubmit}>登录</Button>
						</FormItem>
					</Form>
				</Card>
			</div>
		)
	};
	
	handleSubmit = () => {
		let userInfo = this.props.form.getFieldsValue();
		this.props.form.validateFields((err, values)=>{
			if(!err){
				message.success(`hi ${userInfo.userName}! 你的密码为：${userInfo.userPwd}`)

			}
		})
	};
	
};

```
export default Form.create()(FormLogin);

实现antd封装好的 初始化值 输入数据验证
也可以实现类似vue的双向绑定

Form.create()
这是一个高阶函数，传入的是react组件，返回一个新的react组件，在函数内部会对传入组件进行改造，添加上一定的方法用于进行一些秘密操作 
经 Form.create() 包装过的组件会自带 this.props.form 属性

### 注册表单

``` javascript
const FormItem = Form.Item;
const Radiogroup = Radio.Group;
const TextArea = Input.TextArea;

class FormRegister extends Component{

	state = {}

	render(){

		const { getFieldDecorator } = this.props.form;
		const formItemLayout = {
			labelCol: {
				xs: 24,
				sm: 4
			},
			wrapperCol: {
				xs: 24,
				sm: 15
			}

		};

		const offsetLayout = {
			wrapperCol: {
				xs: 24,
				sm: {
					span: 12,
					offset: 4
				}
			}
		}

		return(
			<div>
				<Card title="注册表单">
					<Form layout="horizontal">
						
						<FormItem label="头像" {...formItemLayout}>
							{
								getFieldDecorator('userImg')(
									<Upload
										listType="picture-card"
										action="//jsonplaceholder.typicode.com/posts/"
										showUploadList={false}
										onChange={this.handlePicUpload}
									
									>
									{this.state.userImg?<img style={{width:102, height:102}} src={this.state.userImg} alt="" />:<Icon type="plus" />}
									</Upload>
								)
							}
						</FormItem>	

						<FormItem label="用户名" {...formItemLayout}>
							{
								getFieldDecorator('userName', {
									initialValue: '',
									rules: [
										{
											required: true,
											message: '用户名不能为空'
										}
									]
								})(
									<Input placeholder='请输入用户名' />
								)
							}
						</FormItem>	

						<FormItem label="密码" {...formItemLayout}>
							{
								getFieldDecorator('userPwd', {
									initialValue: '',
									rules: [
										{
											required: true,
											message: '密码不能为空'
										}
									]
								})(
									<Input type="password" placeholder='请输入密码' />
								)
							}
						</FormItem>

						<FormItem label="性别" {...formItemLayout}>
							{
								getFieldDecorator('sex', {
									initialValue: '1'
								})(
									<Radiogroup>
										<Radio value="1">男</Radio>
										<Radio value="2">女</Radio>
									</Radiogroup>
								)
							}
						</FormItem>
						
						<FormItem label="年龄" {...formItemLayout}>
							{
								getFieldDecorator('sex', {
									initialValue: '18'
								})(
									<InputNumber />
								)
							}
						</FormItem>
						
						<FormItem label="生日" {...formItemLayout}>
							{
								getFieldDecorator('birthday', {
									// 引入moment插件 利用moment对象初始化value
									initialValue: moment('2019-08-18')
								})(
									<DatePicker 
										showTime
										format="YYYY-MM-DD HH:mm:ss"
									/>
								)
							}
						</FormItem>

						<FormItem label="时间" {...formItemLayout}>
							{
								getFieldDecorator('time')(
									<TimePicker
									/>
								)
							}
						</FormItem>

						<FormItem label="当前状态" {...formItemLayout}>
							{
								getFieldDecorator('state', {
									initialValue: '1'
								})(
									<Select>
										<option value='1'>学生</option>
										<option value='2'>教师</option>
										<option value='3'>哒哒</option>
										<option value='4'>滴滴</option>
									</Select>
								)
							}
						</FormItem>

						<FormItem label="爱好" {...formItemLayout}>
							{
								getFieldDecorator('state', {
									initialValue: '1'
								})(
									<Select mode="multiple">
										<option value='1'>学生</option>
										<option value='2'>教师</option>
										<option value='3'>哒哒</option>
										<option value='4'>滴滴</option>
									</Select>
								)
							}
						</FormItem>

						<FormItem label="是否已婚" {...formItemLayout}>
							{
								getFieldDecorator('isMarried', {
									valuePropName: 'checked',
									initialValue: false
								})(
									<Switch />
								)
							}
						</FormItem>

						<FormItem label="联系地址" {...formItemLayout}>
							{
								getFieldDecorator('address')(
									<TextArea
										autosize={
											{
												minRows: 4,
												maxRows: 6
											}
										}
									/>
								)
							}
						</FormItem>
						
						<FormItem {...offsetLayout}>
							{
								getFieldDecorator('address')(
									<Checkbox>我已阅读<a href="#/">使用协议</a></Checkbox>
								)
							}
						</FormItem>
						
						<FormItem {...offsetLayout}>
							<Button type="primary" onClick="this.handleSubmit">注册</Button>

						</FormItem>
					</Form>				
				</Card>
			</div>
		)
	};
	

	getBase64 = (img, callback) => {
	  const reader = new FileReader();
	  reader.addEventListener('load', () => callback(reader.result));
	  reader.readAsDataURL(img);
	};

	handlePicUpload = (info) => {
	   if(info.file.status === 'uploading') {
	      this.setState({ loading: true });
	      return;
	    }

	    if(info.file.status === 'done') {
	      // Get this url from response in real world.
	      this.getBase64(info.file.originFileObj, imageUrl => this.setState({
	        userImg: imageUrl,
	        loading: false,
	      }));
	    }
	};

	handleSubmit = () => {
		// 提交后取得所有表单数据 一个dict
		let userInfo = this.props.form.getFieldsValue();
	}


};
```