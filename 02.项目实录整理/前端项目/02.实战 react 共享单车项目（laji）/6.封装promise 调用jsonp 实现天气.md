---
title: 13
categories:
  - 项目实录整理
  - 前端项目
  - 04.实战 react 共享单车项目（lese）
---

axios.index.js:


```
import JsonP from 'jsonp';

export default class Axios {
	static jsonp(options) {
		return new Promise((resolve, reject)=>{
			JsonP(options.url,{
				param: 'callback'
			}, function(err, response) {
					if(response.status == '1'){
						resolve(response);
					}else{
						reject(response.message);
					}
			})
		})
	}

}

```

header.index.js:


```javascript
componentWillMount(){
		this.setState({
			userName: 'dadada'
		})

setInterval(() => {
	let sysTime = Util.formateDate(new Date().getTime());
	this.setState({
		sysTime
	})
}, 1000)

this.getWeatherAPIData();
}

getWeatherAPIData(){
	let city = '110101'
	axios.jsonp({
		url: 'https://restapi.amap.com/v3/weather/weatherInfo?city='+city+'&key=92ee3c690579ad7a925abd10427d73db'
	}).then((res) => {
		if(res.status == '1'){
			let data = res.lives[0];
			this.setState({
				weather: data.weather
			});
		}
	})

}
```
