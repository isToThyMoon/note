---
title: 13
categories:
  - 项目实录整理
  - 前端项目
  - 04.实战 react 共享单车项目（lese）
---

订单列表
```
import React, { Component } from 'react';
import  { Card, Button, Table, Form, Select, Modal, message, DatePicker } from 'antd';
import Axios from '../../axios/index.js';
import Utils from '../../utils/utils.js';


class Order extends Component{

	state = {
		orderFinishVisible: false,
		orderInfo: {}
	};
	
	params = {
		page: 1
	};
	
	//首次渲染
	componentDidMount(){
		this.requestList()
	};
	
	//请求数据
	requestList = ()=>{

		let _this = this;

		Axios.ajax({
			url: '/order/list',
			data: {
				params:{
					page: this.params.page
				}
			}
		}).then((res)=>{
			this.setState({
					list: res.result.item_List.map((item, index)=>{
						item.key = index;
						return item;
					}),
					pagination: Utils.pagination(res, (current)=>{
						_this.params.page = current;
						this.requestList();
					})
			})
		})
	}
	
	//显隐结束订单modal 请求当前车辆信息
	handleClickFinish = ()=>{
		Axios.ajax({
			url: '/order/bike_info',
			data: {
				params:1
			}
		}).then((res)=>{
			this.setState({
				orderInfo:res.result,
				orderFinishVisible: true
			})
		})

		this.setState({
			orderFinishVisible: true
		})
	}
	
	//结束订单
	handleFinishOrder = ()=>{
		
	}

	render(){
		const columns = [
			{
				title:'订单编号',
				dataIndex:'order_sn'
			},{
				title:'车辆编号',
				dataIndex:'bike_sn'
			},{
				title:'用户名',
				dataIndex:'user_name'
			},{
				title:'手机号',
				dataIndex:'mobile'
			},{
				title:'里程',
				dataIndex:'distance'
			},{
				title:'行驶时长',
				dataIndex:'total_time'
			},{
				title:'状态',
				dataIndex:'status'
			},{
				title:'开始时间',
				dataIndex:'start_time'
			},{
				title:'结束时间',
				dataIndex:'end_time'
			},{
				title:'订单金额',
				dataIndex:'total_fee'
			},{
				title:'实付金额',
				dataIndex:'user_pay'
			},

		];
		
		const formItemLayout = {
			labelCol: {span:5},
			wrapperCol: {span:19}
		}
		
		const rowSelection = {
			type: 'radio'
		}
		return (
			<div>

				<Card>
					<Button type="primary">订单详情</Button>
					<Button onClick={this.handleClickFinish}>结束订单</Button>
				</Card>

				<Card>
					<FilterForm />
				</Card>

				<div className="table-content-wrap">
					<Table
						columns={columns}
						rowSelection={rowSelection}
						dataSource={this.state.list}
						pagination={this.state.pagination}
					/>
				</div>

				<Modal
					title="结束订单"
					width={600}
					visible={this.state.orderFinishVisible}
					onCancel={()=>{
						this.setState({
							orderFinishVisible: false
						})
					}}
					onOk={this.handleFinishOrder}
				>
					<Form layout="horizontal">
						<FormItem label="车辆编号" {...formItemLayout}>{this.state.orderInfo.bike_sn}</FormItem>
						<FormItem label="剩余电量" {...formItemLayout}>{this.state.orderInfo.battery}</FormItem>
						<FormItem label="行程开始时间" {...formItemLayout}>{this.state.orderInfo.start_time}</FormItem>
						<FormItem label="当前位置" {...formItemLayout}>{this.state.orderInfo.location}</FormItem>
					</Form>
				</Modal>


			</div>
		);

	};



};


const FormItem = Form.Item;
const Option = Select.Option;

class FilterForm extends Component{

	render(){
		
		const { getFieldDecorator } = this.props.form;
		return (
			<Form layout="inline">

				<FormItem label="城市">
					{
						getFieldDecorator('city_id')(
							<Select palceholder="全部" style={{width:90}}>
								<Option value="1">江苏省</Option>
								<Option value="2">安徽省</Option>
								<Option value="3">浙江省</Option>
								<Option value="4">河北省</Option>
							</Select>
						)
					}
				</FormItem>

				<FormItem label="订单时间">
					{
						getFieldDecorator('start_time')(
							<DatePicker 
								showTime
								format="YYYY-MM-DD HH:mm"
      							placeholder="From"
							    // onChange={}
							    // onOk={}
							/>
						)
					}
->
					{
						getFieldDecorator('end_time')(
							<DatePicker 
								showTime
								format="YYYY-MM-DD HH:mm"
      							placeholder="To"
							    // onChange={}
							    // onOk={}
							/>
						)
					}
				</FormItem>

				<FormItem label="订单状态">
					{
						getFieldDecorator('status')(
							<Select palceholder="全部" style={{width:80}}>
								<Option value="">全部</Option>
								<Option value="1">进行中</Option>
								<Option value="2">结束行程</Option>
							</Select>
						)
					}
				</FormItem>

				<FormItem>
					<Button type="primary" style={{margin:'0 20px'}}>查询</Button>
					<Button>重置</Button>
				</FormItem>

			</Form>
		)
	};
};

FilterForm=Form.create({})(FilterForm);


export default Order;
```


订单基础信息页：